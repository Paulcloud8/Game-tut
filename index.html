<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEZ Balancer: Indonesia (20 Rounds)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for aesthetic */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1f2937 0%, #000000 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .game-container {
            max-width: 900px;
            width: 95%;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            animation: fadeIn 1s ease-out;
        }
        .stat-bar-bg {
            background-color: #4b5563;
        }
        .stat-bar-fill-economic {
            transition: width 0.5s ease-in-out;
            background-color: #10b981; /* Green for economic gain */
        }
        .stat-bar-fill-social {
            transition: width 0.5s ease-in-out;
            background-color: #f59e0b; /* Amber for social/trust */
        }
        .btn-decision {
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .btn-decision:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }
        .btn-decision:active {
            transform: translateY(0);
            box-shadow: none;
        }
        .message-box {
            animation: slideDown 0.3s ease-out;
        }
        .capital-gain {
            color: #4ade80; /* Tailwind green-400 */
            font-weight: bold;
        }
        .capital-loss {
            color: #f87171; /* Tailwind red-400 */
            font-weight: bold;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .policy-profile-item {
            border-left-width: 4px;
        }
    </style>
    <script>
        // Game State Variables
        let state = {
            turn: 1,
            maxTurns: 20,
            economicOutput: 50, // Unbounded
            publicTrust: 50, // Unbounded
            capital: 100,
            isGameRunning: true,
            decisionsMade: [] // Tracks choice for final policy analysis
        };

        // Utility function to categorize the final policy choices
        const generatePolicyProfile = () => {
            const counts = {
                'Labor-Pro-Firm': 0, 'Labor-Pro-Worker': 0,
                'Env-Lax': 0, 'Env-Regulated': 0,
                'Capital-Aggressive': 0, 'Capital-Investment': 0,
                'Integration-FDI-Centric': 0, 'Integration-Local-Focused': 0,
            };

            state.decisionsMade.forEach(d => {
                const key = `${d.axis}-${d.preference}`;
                if (counts[key] !== undefined) {
                    counts[key]++;
                }
            });

            const profile = [];

            // 1. Labor & Wages
            if (counts['Labor-Pro-Firm'] > counts['Labor-Pro-Worker']) {
                profile.push({ title: 'Labor Policy', profile: 'Highly Liberal & Firm-Centric', color: 'border-red-500', summary: 'Wages, contracts, and working hours were largely left to the firms, prioritizing high output and FDI attractiveness over worker protection.' });
            } else if (counts['Labor-Pro-Worker'] > counts['Labor-Pro-Firm']) {
                profile.push({ title: 'Labor Policy', profile: 'Socially Progressive & Worker-Focused', color: 'border-green-500', summary: 'You consistently mandated fair wages, training, and strong contract enforcement, making the SEZ a model for worker welfare, often at the expense of immediate cost savings.' });
            } else {
                 profile.push({ title: 'Labor Policy', profile: 'Balanced or Indecisive', color: 'border-yellow-500', summary: 'Your approach to labor policies was highly mixed, alternating between supporting firms and protecting workers. This likely led to moderate outcomes in both output and trust.' });
            }

            // 2. Environment & Standards
            if (counts['Env-Lax'] > counts['Env-Regulated']) {
                profile.push({ title: 'Environmental Governance', profile: 'Lax and Growth-Oriented', color: 'border-red-500', summary: 'Environmental enforcement was consistently deferred or minimized to avoid cost and speed up construction, favoring pollutive, high-output sectors.' });
            } else if (counts['Env-Regulated'] > counts['Env-Lax']) {
                profile.push({ title: 'Environmental Governance', profile: 'Strict and Sustainable', color: 'border-green-500', summary: 'You mandated costly, high environmental standards, prioritized water and land resources for the community, and attracted green investment, ensuring long-term ecological balance.' });
            } else {
                 profile.push({ title: 'Environmental Governance', profile: 'Pragmatic and Reactive', color: 'border-yellow-500', summary: 'A balanced approach, you invested in cleanup when necessary but often took the path of least resistance on regulation, resulting in moderate standards.' });
            }

            // 3. Capital Strategy & Spending
            if (counts['Capital-Aggressive'] > counts['Capital-Investment']) {
                profile.push({ title: 'Capital Strategy', profile: 'Revenue-Focused & Tax-Conservative', color: 'border-green-500', summary: 'You prioritized immediate revenue and avoided debt/heavy social spending, focusing capital on high-yield, quick-return infrastructure projects.' });
            } else if (counts['Capital-Investment'] > counts['Capital-Aggressive']) {
                profile.push({ title: 'Capital Strategy', profile: 'High Investment & Debt Tolerant', color: 'border-red-500', summary: 'You spent heavily on social amenities, training, and public works, often incurring debt or foregoing immediate revenue for long-term social capacity building.' });
            } else {
                 profile.push({ title: 'Capital Strategy', profile: 'Cautious and Measured', color: 'border-yellow-500', summary: 'Your capital spending was tightly managed, avoiding both excessive risk and high public investment, leading to stable, moderate financial outcomes.' });
            }

            // 4. Local Integration & Spillover
            if (counts['Integration-FDI-Centric'] > counts['Integration-Local-Focused']) {
                profile.push({ title: 'Local Integration', profile: 'Isolated Enclave Model', color: 'border-red-500', summary: 'The SEZ was run as a separate economic enclave, minimizing policy intervention outside its borders, which accelerated structural change but increased local informality and inequality.' });
            } else if (counts['Integration-Local-Focused'] > counts['Integration-FDI-Centric']) {
                profile.push({ title: 'Local Integration', profile: 'Inclusive Spillover Model', color: 'border-green-500', summary: 'You actively invested in local supplier chains, public services, and training programs to ensure the SEZ benefits spilled over to the surrounding regional economy.' });
            } else {
                 profile.push({ title: 'Local Integration', profile: 'Opportunistic Spillover', color: 'border-yellow-500', summary: 'Integration was addressed only when required to maintain stability, leading to an inconsistent policy toward local integration and community development.' });
            }

            return profile;
        };


        // Helper function to format capital effect for display
        const formatCapitalEffect = (effect) => {
            const capitalChange = effect.capital - state.capital;
            if (capitalChange > 0) {
                return `<span class="capital-gain">(+${capitalChange} Capital)</span>`;
            } else if (capitalChange < 0) {
                return `<span class="capital-loss">(${capitalChange} Capital)</span>`;
            }
            return ``;
        };
        
        // --- DECISION SCENARIOS (Total of 20 unique decisions for 20 turns) ---
        const DECISIONS = [
            // Turn 1: Land Dispossession / Compensation
            {
                title: "Land Acquisition for Phase I",
                prompt: "Your SEZ needs 500 Hectares, requiring displacement of a local farming community. How do you handle compensation and social license?",
                options: [
                    {
                        text: "Rapid, Expedited Acquisition: Use eminent domain powers; minimal compensation based only on legal minimums to save time and capital.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 15, publicTrust: s.publicTrust - 25, capital: s.capital + 50,
                            message: "The rapid land clearance attracted immediate investors (+15 Output, +50 Capital), but the low compensation has caused severe public unrest and land rights disputes (-25 Trust)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'FDI-Centric' }
                    },
                    {
                        text: "Community Partnership: Offer above-market compensation, investment in new local schools, and guaranteed SEZ training slots for displaced youth.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 15, capital: s.capital - 60,
                            message: "The community partnership secured social license (+15 Trust). Development is slow and costly (-60 Capital), but sustainable (+5 Output)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'Local-Focused' }
                    }
                ]
            },
            // Turn 2: FDI / Labor Market Quality Trade-off
            {
                title: "Incentivizing a Flagship Manufacturer",
                prompt: "A global electronics firm is interested. They demand deep tax breaks and a 'flexible' (read: low regulation) labor environment.",
                options: [
                    {
                        text: "Offer Total Flexibility: Grant 10-year tax holiday and ignore demands for strong minimum wage or anti-union clauses.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 25, publicTrust: s.publicTrust - 15, capital: s.capital + 10,
                            message: "FDI surged, boosting Economic Output (+25) and saving capital on monitoring (+10). Reports of poor contract terms have created public outrage (-15 Trust)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Firm' }
                    },
                    {
                        text: "Require Policy Compliance: Enforce mandated minimum wages, formal contracts, and union access. Offer a shorter tax holiday.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust + 10, capital: s.capital - 25,
                            message: "The SEZ's reputation for quality labor has increased Trust (+10). Output growth is moderate (+10), but capital was spent on formalized labor oversight (-25 Capital)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Worker' }
                    }
                ]
            },
            // Turn 3: Informality Spillover Trade-off (Linking SEZ to Local Economy)
            {
                title: "Managing Rural-to-Urban Migration",
                prompt: "The SEZ is pulling young workers from surrounding farms, leading to high informal sector employment (street vendors, low-wage services) just outside the zone's gates. This creates instability.",
                options: [
                    {
                        text: "Containment Policy: Build a physical security wall and focus resources only on formal employment within the SEZ. Ignore the 'informal spillover'.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 15, publicTrust: s.publicTrust - 15, capital: s.capital + 0,
                            message: "Containment accelerated industrial growth (+15 Output). The resulting social dislocation and non-SEZ informality have hurt Public Trust (-15 Trust)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'FDI-Centric' }
                    },
                    {
                        text: "Formalization Initiative: Invest capital in micro-loans, vocational training, and permits to formalize the local service sector and link it to SEZ supply chains.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 10, capital: s.capital - 35,
                            message: "Formalization efforts are easing the transition and stabilizing the local economy (+10 Trust). This is a heavy capital expense (-35 Capital) but provides slow, steady output growth (+5 Output)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'Local-Focused' }
                    }
                ]
            },
             // Turn 4: Environmental Policy / Cost Trade-off
            {
                title: "Effluent Treatment Standards",
                prompt: "A key metals processing factory generates highly profitable output but also toxic liquid effluent. Local NGOs demand a cutting-edge (and costly) zero-discharge system.",
                options: [
                    {
                        text: "Minimum Compliance: Adopt the cheapest available wastewater treatment (standard compliance), saving capital for other projects.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust - 10, capital: s.capital + 15,
                            message: "The factory saved millions, boosting capital (+15) and output (+10). Environmental concerns remain, causing minor Trust erosion (-10 Trust)."
                        }),
                        policyAxis: { axis: 'Env', preference: 'Lax' }
                    },
                    {
                        text: "Mandate Zero-Discharge: Force the manufacturer to invest in and operate the high-cost, zero-discharge system.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 5, publicTrust: s.publicTrust + 15, capital: s.capital - 20,
                            message: "Strict enforcement improved Trust (+15) and secured sustainability. However, the high cost slightly reduced the factory's output capacity (-5 Output) and required SEZ co-investment (-20 Capital)."
                        }),
                        policyAxis: { axis: 'Env', preference: 'Regulated' }
                    }
                ]
            },
            // Turn 5: Infrastructure Funding / Debt Trade-off
            {
                title: "High-Speed Logistics Corridor",
                prompt: "A necessary highway link to the regional airport is unfunded. Should you secure a high-interest private loan for immediate completion or issue a public bond, delaying the project?",
                options: [
                    {
                        text: "Private Loan: Take a high-interest private loan to finish the link within 6 months.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 20, publicTrust: s.publicTrust - 10, capital: s.capital + 60,
                            message: "The quick link drastically increased logistics efficiency (+20 Output). The high debt load and non-transparent private deal have reduced Public Trust (-10 Trust). (+60 Capital initial influx)"
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Aggressive' }
                    },
                    {
                        text: "Public Bond Issuance: Wait 18 months for secure public financing via bonds, delaying the logistics benefits.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 5, publicTrust: s.publicTrust + 5, capital: s.capital + 5,
                            message: "Fiscally responsible and transparent (+5 Trust, +5 Capital). The project delay, however, constrained current export capacity and limited growth (-5 Output)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Investment' }
                    }
                ]
            },
            // Turn 6: Corruption / Integrity Trade-off
            {
                title: "Zoning Permit Obstruction",
                prompt: "A large SEZ development is stalled by local zoning officials hinting that a 'special fund contribution' (bribe) is necessary to issue final permits.",
                options: [
                    {
                        text: "Establish the 'Special Fund': Make the required payment using SEZ capital to unblock the project immediately.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 15, publicTrust: s.publicTrust - 20, capital: s.capital - 15,
                            message: "The project is back on track, generating immediate output growth (+15 Output). News of the payoff has severely damaged Public Trust (-20 Trust) and cost Capital (-15)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Firm' }
                    },
                    {
                        text: "Report to Anti-Corruption: Refuse the payment and launch a formal complaint and transparency investigation.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 10, publicTrust: s.publicTrust + 15, capital: s.capital - 5,
                            message: "The investigation delayed the project (-10 Output) and incurred legal fees (-5 Capital), but your commitment to integrity boosted Public Trust (+15 Trust)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Investment' }
                    }
                ]
            },
            // Turn 7: Expatriate Housing vs. Local Housing Crisis
            {
                title: "SEZ Executive Housing",
                prompt: "Foreign executives demand high-quality, guarded housing complexes near the SEZ, requiring you to reserve prime land. Meanwhile, local workers are struggling with high rent and overcrowding.",
                options: [
                    {
                        text: "Prioritize Executive Needs: Allocate SEZ funds and prime land to build the exclusive executive village.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust - 15, capital: s.capital - 25,
                            message: "Executive recruitment improved, boosting management efficiency (+10 Output). Locals resent the luxury enclave amid their housing crisis, significantly hurting Trust (-15 Trust). (-25 Capital)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'FDI-Centric' }
                    },
                    {
                        text: "Subsidize Worker Dormitories: Use the land and funds to build high-density, subsidized worker dormitories and affordable local housing.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 10, capital: s.capital - 40,
                            message: "Improved worker welfare led to better morale (+10 Trust) and slight efficiency gains (+5 Output). This major social investment was costly (-40 Capital)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'Local-Focused' }
                    }
                ]
            },
            // Turn 8: Technology Transfer Mandate
            {
                title: "Technology Transfer Policy",
                prompt: "Should you mandate foreign firms to formally transfer a percentage of their Intellectual Property (IP) and technical know-how to local joint ventures, risking FDI backlash?",
                options: [
                    {
                        text: "Mandate Transfer: Enforce a strict technology transfer requirement for all high-tech FDI.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 10, capital: s.capital - 10,
                            message: "Long-term local capacity is boosted (+10 Trust, +5 Output). Several cautious FDI proposals were withdrawn, slightly slowing immediate growth and incurring legal setup costs (-10 Capital)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'Local-Focused' }
                    },
                    {
                        text: "Voluntary Transfer: Maintain a policy of voluntary, market-driven technology sharing, preserving FDI appeal.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 15, publicTrust: s.publicTrust - 5, capital: s.capital + 5,
                            message: "Reduced regulatory hurdle boosted immediate FDI (+15 Output, +5 Capital saved). Local experts criticized the lack of mandated long-term knowledge gain (-5 Trust)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'FDI-Centric' }
                    }
                ]
            },
            // Turn 9: Tax Review / Revenue Trade-off
            {
                title: "Tax Incentive Sunset Clause",
                prompt: "The generous tax holidays for the first wave of investors are expiring. Do you extend them to maintain commitment, or let them lapse to collect revenue for regional development?",
                options: [
                    {
                        text: "Extend Tax Breaks: Renew the tax holidays for an additional five years for key established investors.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 15, publicTrust: s.publicTrust - 10, capital: s.capital - 30,
                            message: "Investors guaranteed continued high output (+15 Output). The public views this as favoritism, severely cutting into public revenue (-30 Capital loss) and lowering Trust (-10 Trust)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Aggressive' }
                    },
                    {
                        text: "Allow Lapse: Allow taxes to return to normal rates, generating public revenue for local infrastructure outside the SEZ.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 5, publicTrust: s.publicTrust + 15, capital: s.capital + 40,
                            message: "Public Trust surged due to the new revenue available (+15 Trust, +40 Capital). Some highly mobile, price-sensitive firms downsized or left (-5 Output)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Investment' }
                    }
                ]
            },
            // Turn 10: Structural Safety Audit
            {
                title: "Structural Safety Standards",
                prompt: "Following a collapse in a neighboring SEZ, should you mandate an expensive, independent structural safety audit for all existing SEZ buildings, potentially causing temporary shutdowns?",
                options: [
                    {
                        text: "Mandate Full Audit: Require immediate, independent, and costly audits of all structures.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 10, publicTrust: s.publicTrust + 15, capital: s.capital - 30,
                            message: "The audit reassured workers and the public (+15 Trust). However, the temporary shutdown and costs severely reduced output (-10 Output) and capital (-30 Capital)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Worker' }
                    },
                    {
                        text: "Self-Certification: Accept company internal safety reports without independent verification, saving time and money.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust - 15, capital: s.capital + 5,
                            message: "No disruption to production (+5 Output, +5 Capital saved). The lack of independent verification made the public highly skeptical and lowered Trust (-15 Trust)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Firm' }
                    }
                ]
            },
            // Turn 11: Digital Infrastructure vs. Rural Electrification
            {
                title: "Next Capital Allocation",
                prompt: "You have excess capital. Should you invest in a state-of-the-art 5G network exclusively for SEZ factories, or fund rural electrification projects in surrounding villages?",
                options: [
                    {
                        text: "5G SEZ Network: Invest heavily in a high-speed digital network to attract specialized, high-tech tenants.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 20, publicTrust: s.publicTrust - 5, capital: s.capital - 40,
                            message: "The digital boost attracted specialized firms (+20 Output). (-40 Capital). However, the public noted the wealth disparity with un-electrified neighbors (-5 Trust)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Aggressive' }
                    },
                    {
                        text: "Rural Electrification: Fund utility expansion outside the SEZ gates to improve community life and education.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 10, capital: s.capital - 35,
                            message: "This act of local development boosted morale and Trust (+10 Trust). The SEZ gains only modest long-term benefits (+5 Output). (-35 Capital)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'Local-Focused' }
                    }
                ]
            },
            // Turn 12: Renewable Energy Mandate
            {
                title: "SEZ Power Source Future",
                prompt: "A coal power plant offers the cheapest, most reliable energy supply. Alternatively, a solar/wind farm offers a clean but slightly more expensive supply for the SEZ.",
                options: [
                    {
                        text: "Coal Power Plant: Sign the contract for cheap, reliable coal power.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust - 10, capital: s.capital + 10,
                            message: "Energy costs plummeted, boosting current output (+10 Output) and capital (+10). Environmental groups and the younger generation severely criticized the decision (-10 Trust)."
                        }),
                        policyAxis: { axis: 'Env', preference: 'Lax' }
                    },
                    {
                        text: "Renewable Farm: Subsidize and mandate the use of the new, clean energy farm.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 15, capital: s.capital - 20,
                            message: "The SEZ is branded as a green zone (+15 Trust, +5 Output). The initial subsidy and slightly higher power costs required a capital outlay (-20 Capital)."
                        }),
                        policyAxis: { axis: 'Env', preference: 'Regulated' }
                    }
                ]
            },
            // Turn 13: Factory Automation vs. Job Protection
            {
                title: "Automation Subsidy Policy",
                prompt: "FDI firms are requesting subsidies to purchase automation robotics, promising higher output per employee but resulting in 20% immediate layoffs.",
                options: [
                    {
                        text: "Grant Automation Subsidies: Fund the firms' transition to robotics for greater efficiency.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 15, publicTrust: s.publicTrust - 20, capital: s.capital - 20,
                            message: "Productivity surged (+15 Output). The mass layoffs devastated worker confidence and public trust (-20 Trust). (-20 Capital in subsidies)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Firm' }
                    },
                    {
                        text: "Reject Subsidies: Mandate that firms must retrain workers for higher-skilled roles instead of laying them off.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 15, capital: s.capital - 10,
                            message: "Worker loyalty and Trust skyrocketed (+15 Trust). Output gains are slower, based on successful retraining (+5 Output). (-10 Capital for retraining support)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Worker' }
                    }
                ]
            },
            // Turn 14: Water Usage / Drought Management
            {
                title: "SEZ vs. Agriculture Water Rights",
                prompt: "The region is in drought. SEZ factories need full water supply to meet export quotas. Local farmers outside the zone face crop failure without immediate diversion.",
                options: [
                    {
                        text: "Prioritize Industry: Sign an executive order ensuring 100% water supply to the SEZ to secure high export revenue.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 15, publicTrust: s.publicTrust - 25, capital: s.capital + 5,
                            message: "Export quotas are met (+15 Output, +5 Capital). The resulting agricultural collapse and community suffering led to a major loss of Trust (-25 Trust)."
                        }),
                        policyAxis: { axis: 'Env', preference: 'Lax' }
                    },
                    {
                        text: "Mandate Diversion: Force factories to reduce consumption by 40% and divert the conserved water to local agriculture.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 15, publicTrust: s.publicTrust + 20, capital: s.capital - 15,
                            message: "The emergency diversion stabilized local communities (+20 Trust). Factory output dropped significantly (-15 Output) and the diversion cost capital (-15 Capital)."
                        }),
                        policyAxis: { axis: 'Env', preference: 'Regulated' }
                    }
                ]
            },
            // Turn 15: Tax Compliance Enforcement
            {
                title: "Investigating Tax Avoidance",
                prompt: "Rumors suggest several foreign firms are using transfer pricing and loopholes to avoid paying legitimate taxes. Do you launch a costly, high-profile audit or let it slide?",
                options: [
                    {
                        text: "Launch Full Audit: Hire specialized auditors to rigorously enforce tax compliance.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 5, publicTrust: s.publicTrust + 15, capital: s.capital - 25,
                            message: "The SEZ's integrity is restored (+15 Trust). The audit spooked some compliant investors and cost significant capital and time (-5 Output, -25 Capital)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Investment' }
                    },
                    {
                        text: "Soft Approach: Issue a warning and negotiate a quiet settlement to avoid controversy and maintain investor confidence.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust - 10, capital: s.capital + 10,
                            message: "Investor confidence remains high (+10 Output) and a small, quiet revenue boost was secured (+10 Capital). The public perceives a 'soft-on-crime' attitude (-10 Trust)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Aggressive' }
                    }
                ]
            },
            // Turn 16: Public Transport vs. Private Vehicles
            {
                title: "Commuter Transit Strategy",
                prompt: "The SEZ is suffering from severe traffic congestion. Do you invest capital into building new roads for private vehicles or subsidize and expand the public bus network?",
                options: [
                    {
                        text: "Expand Private Roads: Build wider roads, tunnels, and parking structures to accommodate private vehicles and firm logistics.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust - 5, capital: s.capital - 35,
                            message: "Logistics improved (+10 Output). The decision disproportionately benefited wealthier workers and exacerbated air pollution (-5 Trust). (-35 Capital)."
                        }),
                        policyAxis: { axis: 'Env', preference: 'Lax' }
                    },
                    {
                        text: "Subsidize Public Transit: Invest heavily in a clean, efficient bus network and shuttle system for all workers.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 10, capital: s.capital - 45,
                            message: "Worker morale and local trust improved (+10 Trust). Traffic congestion eased slightly (+5 Output). This major civic investment was costly (-45 Capital)."
                        }),
                        policyAxis: { axis: 'Env', preference: 'Regulated' }
                    }
                ]
            },
            // Turn 17: Local SME Exemption
            {
                title: "Support for Local Small Businesses (SMEs)",
                prompt: "Local Indonesian SMEs outside the SEZ complain they cannot compete with the large, tax-exempt foreign firms inside. Do you grant them a capital subsidy or let market forces decide?",
                options: [
                    {
                        text: "Grant Subsidies: Provide matching grants and training to boost local SME competitiveness.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 5, publicTrust: s.publicTrust + 15, capital: s.capital - 20,
                            message: "The local economy got a vital boost (+15 Trust, +5 Output). This was a significant capital cost (-20 Capital)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'Local-Focused' }
                    },
                    {
                        text: "Maintain Strict Policy: Decline subsidies, arguing they distort the free market principles of the SEZ.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust - 10, capital: s.capital + 5,
                            message: "The strict, hands-off approach pleased global economists and saved capital (+10 Output, +5 Capital). Local businesses and communities felt abandoned (-10 Trust)."
                        }),
                        policyAxis: { axis: 'Integration', preference: 'FDI-Centric' }
                    }
                ]
            },
            // Turn 18: Gender Equality vs. Production Targets
            {
                title: "Gender Pay Gap Audit",
                prompt: "An internal SEZ study reveals a 15% pay gap between male and female workers. Mandating an immediate, enforced equalization will be costly for firms and may trigger resistance.",
                options: [
                    {
                        text: "Enforce Immediate Equalization: Mandate salary reviews and immediate compliance with equal pay standards, risking firm protest.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 5, publicTrust: s.publicTrust + 20, capital: s.capital - 10,
                            message: "Gender equity achieved, greatly boosting Trust (+20). Firms resisted the cost, leading to minor production dips (-5 Output) and administrative costs (-10 Capital)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Worker' }
                    },
                    {
                        text: "Voluntary Guidelines: Issue non-binding best-practice guidelines and let firms self-regulate.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust - 15, capital: s.capital + 5,
                            message: "Firms maintained output (+10 Output, +5 Capital saved). The failure to act decisively on equity caused a major loss of Trust among workers and advocates (-15 Trust)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Firm' }
                    }
                ]
            },
            // Turn 19: Budgeting for Social Safety Net
            {
                title: "Creating a SEZ Social Safety Net",
                prompt: "Should you commit 10% of annual SEZ profit to fund a permanent unemployment and pension fund for SEZ workers (major long-term cost), or keep the capital for expansion?",
                options: [
                    {
                        text: "Fund Safety Net: Commit to the permanent unemployment and pension fund.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput - 5, publicTrust: s.publicTrust + 20, capital: s.capital - 40,
                            message: "The ultimate worker safety net was established (+20 Trust). The high annual commitment reduced immediate expansion capital (-40 Capital) and slightly constrained profit growth (-5 Output)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Investment' }
                    },
                    {
                        text: "Reserve for Expansion: Maintain all profit for future infrastructure and land purchases.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 15, publicTrust: s.publicTrust - 10, capital: s.capital + 30,
                            message: "Capital is robust for expansion (+15 Output, +30 Capital). The lack of a guaranteed safety net for workers caused anxiety and lowered Trust (-10 Trust)."
                        }),
                        policyAxis: { axis: 'Capital', preference: 'Aggressive' }
                    }
                ]
            },
            // Turn 20: Final Long-Term Strategy
            {
                title: "Defining the Future SEZ Model",
                prompt: "After 20 years, your SEZ is mature. What is the defining strategic direction for the next decade?",
                options: [
                    {
                        text: "Focus on Scale: Offer maximum incentives for high-volume, low-margin manufacturing, optimizing for sheer size and export volume.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 20, publicTrust: s.publicTrust - 5, capital: s.capital + 15,
                            message: "Guaranteed large-scale contracts boost output (+20) and capital (+15). This choice sacrifices long-term innovation potential and disappointed high-skill advocates (-5 Trust)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Firm' }
                    },
                    {
                        text: "Focus on Value: Invest aggressively in specialized infrastructure and attract only high-skill, low-volume, R&D-intensive tech firms.",
                        effect: (s) => ({
                            economicOutput: s.economicOutput + 10, publicTrust: s.publicTrust + 15, capital: s.capital - 40,
                            message: "This bold future vision boosted long-term confidence (+15 Trust). The immediate shift is capital intensive (-40 Capital), offering slow but high-quality growth (+10 Output)."
                        }),
                        policyAxis: { axis: 'Labor', preference: 'Pro-Worker' }
                    }
                ]
            }
        ];

        // Function to update the game state and UI
        function updateGame(decisionIndex, optionIndex) {
            if (!state.isGameRunning) return;

            const decision = DECISIONS[decisionIndex];
            const option = decision.options[optionIndex];
            
            const result = option.effect(state);

            // Store the decision made before applying effects
            state.decisionsMade.push({
                turn: state.turn,
                title: decision.title,
                choice: option.text,
                impact: result.message,
                axis: option.policyAxis.axis,
                preference: option.policyAxis.preference
            });

            // Apply effects (NO CLAMPING for unbounded growth)
            state.economicOutput = result.economicOutput;
            state.publicTrust = result.publicTrust;
            state.capital = result.capital;
            state.turn++;

            // Display message
            document.getElementById('message-box').innerHTML = result.message;
            document.getElementById('message-box').classList.remove('hidden');

            // Check for game over or win condition
            if (state.publicTrust < 10) { // Set a low, non-zero threshold for Trust failure
                endGame(false, `Public Trust has collapsed below 10 (${state.publicTrust}). MASSIVE PROTESTS and political instability have forced the suspension of the SEZ project.`);
            } else if (state.capital < 0) {
                 endGame(false, `You ran out of Capital. Without funds for operations or infrastructure, the project has collapsed with a debt of Rp ${Math.abs(state.capital)} M.`);
            } else if (state.turn > state.maxTurns) {
                endGame(true, "FINAL TURN REACHED! You successfully navigated 20 years of complex SEZ development and trade-offs. Review your legacy below.");
            } else {
                renderUI();
            }
        }

        // Function to end the game
        function endGame(isWin, finalMessage) {
            state.isGameRunning = false;
            // Unbounded metrics, so scoring is purely based on final values
            let finalScore = state.economicOutput + state.publicTrust + (state.capital / 10); 
            
            // Generate the Policy Profile
            const policyProfile = generatePolicyProfile();
            
            let profileHTML = policyProfile.map(p => `
                <div class="policy-profile-item ${p.color} bg-gray-700 p-4 rounded-lg shadow-md mb-4">
                    <h4 class="text-xl font-bold text-gray-100">${p.title}: <span class="text-yellow-400">${p.profile}</span></h4>
                    <p class="text-sm text-gray-300 mt-1">${p.summary}</p>
                </div>
            `).join('');


            let endingText = "";
            if (isWin) {
                endingText = `SEZ PROJECT COMPLETE. Your final combined score is ${Math.round(finalScore)}.`;
                if (state.economicOutput > 300 && state.publicTrust > 150) {
                    endingText += " (Exceptional Success! A global model for balanced and sustainable development.)";
                } else if (state.economicOutput > 400 && state.publicTrust < 100) {
                    endingText += " (Economic Giant, Social Tensions. Rapid growth came at the cost of the people's welfare.)";
                } else if (state.economicOutput < 200 && state.publicTrust > 250) {
                    endingText += " (Social Success, Economic Struggle. High trust but low output suggests missed opportunities for growth.)";
                } else {
                    endingText += " (Solid Achievement. You balanced the trade-offs successfully.)";
                }
            } else {
                 endingText = `PROJECT FAILED in Turn ${state.turn - 1}. ${finalMessage} Final Score: ${Math.round(finalScore)}.`;
            }

            document.getElementById('game-content').innerHTML = `
                <div class="text-center p-8 bg-gray-700 rounded-xl">
                    <h2 class="text-3xl font-bold mb-4 text-white">${isWin ? '20-TURN LEGACY COMPLETE' : 'PROJECT FAILED'}</h2>
                    <p class="text-lg mb-6 text-gray-300">${finalMessage}</p>
                    <p class="text-2xl font-extrabold mb-8 text-yellow-400">${endingText}</p>
                    
                    <h3 class="text-2xl font-bold mb-4 text-white border-t border-gray-600 pt-6">Your Final Policy Profile</h3>
                    <div class="max-h-[500px] overflow-y-auto text-left mx-auto p-4 bg-gray-800 rounded-lg">
                        ${profileHTML}
                    </div>

                    <button onclick="resetGame()" class="mt-8 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-lg shadow-lg">Start New Game</button>
                </div>
            `;
        }

        // Function to reset the game
        function resetGame() {
            state = {
                turn: 1,
                maxTurns: 20,
                economicOutput: 50,
                publicTrust: 50,
                capital: 100,
                isGameRunning: true,
                decisionsMade: [] // Reset decision history
            };
            document.getElementById('message-box').classList.add('hidden');
            renderUI();
        }

        // Function to render the UI based on current state
        function renderUI() {
            const container = document.getElementById('game-content');
            const currentDecisionIndex = state.turn - 1;
            
            if (currentDecisionIndex >= DECISIONS.length) {
                endGame(true, "All decisions completed.");
                return;
            }

            const currentDecision = DECISIONS[currentDecisionIndex];

            // --- Unbounded Metric Bar Visualization ---
            const visualMax = 200; // Visual cap for the bar
            
            // Calculate visual percentage (capped at 100% full)
            const econPercent = Math.min(100, (state.economicOutput / visualMax) * 100);
            const trustPercent = Math.min(100, (state.publicTrust / visualMax) * 100);

            // Render stats panel
            document.getElementById('turn-counter').innerText = `${state.turn} / ${state.maxTurns}`;
            document.getElementById('capital-value').innerText = `Rp ${state.capital} M`;
            
            // Apply visual width
            document.getElementById('economic-bar-fill').style.width = `${econPercent}%`;
            document.getElementById('social-bar-fill').style.width = `${trustPercent}%`;

            // Display actual numerical value (unbounded)
            document.getElementById('economic-bar-value').innerText = `${Math.round(state.economicOutput)}`;
            document.getElementById('social-bar-value').innerText = `${Math.round(state.publicTrust)}`;

            // Render decision panel
            let decisionHTML = `
                <h3 class="text-xl font-bold mb-4 text-white">${currentDecision.title}</h3>
                <p class="mb-6 text-gray-300">${currentDecision.prompt}</p>
                <div class="space-y-4">
            `;

            currentDecision.options.forEach((option, index) => {
                 // Temporarily calculate the effect just to get the capital change for display
                const tempState = {...state}; 
                const tempResult = option.effect(tempState);
                const capitalDisplay = formatCapitalEffect(tempResult);

                decisionHTML += `
                    <button 
                        onclick="updateGame(${currentDecisionIndex}, ${index})" 
                        class="btn-decision w-full text-left p-4 bg-gray-800 hover:bg-gray-700 text-white rounded-lg shadow-md border border-gray-600 flex justify-between items-start"
                    >
                        <span class="flex-1">${option.text}</span>
                        ${capitalDisplay}
                    </button>
                `;
            });

            decisionHTML += `</div>`;
            container.innerHTML = decisionHTML;
        }

        // Initialize game on load
        window.onload = resetGame;
    </script>
</head>
<body>

    <div class="game-container bg-gray-900 rounded-xl p-6 md:p-10 border-4 border-yellow-500">
        <h1 class="text-3xl font-extrabold text-center mb-6 text-yellow-400 uppercase tracking-wider">
            SEZ Balancer: Indonesia
        </h1>
        <p class="text-center text-gray-400 mb-6">
            **Trade-off Challenge:** Guide your Special Economic Zone through 20 years of political and economic pressures.
        </p>

        <!-- Stats Panel -->
        <div class="grid grid-cols-3 gap-4 mb-8 p-4 bg-gray-800 rounded-lg">
            <div class="text-center">
                <p class="text-sm font-semibold text-gray-400">TURN</p>
                <p id="turn-counter" class="text-3xl font-bold text-white">1 / 20</p>
            </div>
            <div class="text-center">
                <p class="text-sm font-semibold text-gray-400">CAPITAL (Rp)</p>
                <p id="capital-value" class="text-3xl font-bold text-indigo-400">Rp 100 M</p>
            </div>
            <div class="text-center">
                <p class="text-sm font-semibold text-gray-400">SEZ GOAL</p>
                <p class="text-3xl font-bold text-gray-200">20-Year Legacy</p>
            </div>
        </div>

        <!-- Metric Bars -->
        <div class="space-y-4 mb-8">
            <div>
                <div class="flex justify-between items-center mb-1">
                    <span class="text-md font-semibold text-white"> Economic Output</span>
                    <span id="economic-bar-value" class="text-lg font-bold text-green-400">50</span>
                </div>
                <div class="stat-bar-bg h-3 rounded-full overflow-hidden">
                    <div id="economic-bar-fill" class="stat-bar-fill-economic h-full" style="width: 25%;"></div>
                </div>
            </div>
            
            <div>
                <div class="flex justify-between items-center mb-1">
                    <span class="text-md font-semibold text-white"> Public Trust</span>
                    <span id="social-bar-value" class="text-lg font-bold text-amber-400">50</span>
                </div>
                <div class="stat-bar-bg h-3 rounded-full overflow-hidden">
                    <div id="social-bar-fill" class="stat-bar-fill-social h-full" style="width: 25%;"></div>
                </div>
                <p class="text-xs text-red-400 mt-1">Trust must not drop below 10. Capital must not drop below 0.</p>
            </div>
        </div>

        <!-- Dynamic Message Box -->
        <div id="message-box" class="message-box hidden p-4 mb-6 text-sm bg-blue-900 text-blue-200 rounded-lg border border-blue-700">
            <!-- Decision feedback appears here -->
        </div>

        <!-- Game Content (Decision Panel) -->
        <div id="game-content">
            <!-- Content will be injected by JavaScript -->
        </div>
    </div>

</body>
</html>